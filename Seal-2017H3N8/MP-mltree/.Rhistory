res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = F) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_point2(aes(subset = !isTip & !is.na(label) & label > 75), shape = 18, size = 3) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_hilight(node = 40, fill = "gray", alpha = .6, extendto  =  1) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18))
p
dev.off()
ggtree(MPtree) +  geom_tiplab(align = T) + xlim(NA, 0.1) +
geom_text2(aes(subset = !isTip, label = node, hjust = 1.2, vjust = -0.8, size = 3))
png(filename = "MP-ML-2.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = F) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_point2(aes(subset = !isTip & !is.na(label) & label > 75), shape = 18, size = 3) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
geom_hilight(node = 65, fill = "gray", alpha = .6, extendto  =  1) +
theme(text = element_text(size =18))
p
dev.off()
png(filename = "MP-ML-2.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = F) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodepoint(aes(subset = !isTip & !is.na(label) & label > 75), shape = 18, size = 3) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
geom_hilight(node = 65, fill = "gray", alpha = .6, extendto  =  1) +
theme(text = element_text(size =18))
p
dev.off()
png(filename = "MP-ML-2.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = F) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodepoint(aes(subset = !isTip & !is.na(label) & label > 75), shape = 18, size = 3) +
geom_hilight(node = 65, fill = "gray", alpha = .6, extendto  =  1) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18))
p
dev.off()
png(filename = "MP-ML-2.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = F) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodepoint(aes(subset = !isTip & !is.na(label) & label > 75), shape = 18, size = 3) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) +
geom_hilight(node = 65, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
png(filename = "MP-ML-2.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = F) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodepoint(aes(subset = !isTip & !is.na(label) & label > 75), shape = 18, size = 3) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) +
geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
png(filename = "MP-ML-2.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = F) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodepoint(aes(subset = !isTip & !is.na(label) & label > 75), shape = 18, size = 3) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
rm(list=ls())
MPtree <- read.tree("MP-hits-q-sed-mauto-trim.tre")
midMPtree <- ape::root.phylo(MPtree, node = 53)
midMPtree$node.label
ggtree(MPtree) +  geom_tiplab(align = T) + xlim(NA, 0.1) +
geom_text2(aes(subset = !isTip, label = node, hjust = 1.2, vjust = -0.8, size = 3))
png(filename = "MP-ML-2.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = F) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodepoint(aes(subset = !isTip & !is.na(label) & label > 75), shape = 18, size = 3) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
png(filename = "MP-ML-2.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodepoint(aes(subset = !isTip & !is.na(label) & label > 75), shape = 18, size = 3) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
ggtree(MPtree) +  geom_tiplab(align = T) + xlim(NA, 0.1) +
geom_text2(aes(subset = !isTip, label = node, hjust = 1.2, vjust = -0.8, size = 2))
midMPtree <- ape::root.phylo(MPtree, node = 59)
png(filename = "MP-ML-2.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodepoint(aes(subset = !isTip & !is.na(label) & label > 75), shape = 18, size = 3) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library(treeio)
MPtree <- read.tree("MP-hits-q-sed-mauto-trim.tre")
midMPtree <- ape::root.phylo(MPtree, node = 59)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodepoint(aes(label = label)), shape = 18, size = 3) +
library(ggtree)
ggtree(MPtree) +  geom_tiplab(align = T) + xlim(NA, 0.1) +
geom_text2(aes(subset = !isTip, label = node, hjust = 1.2, vjust = -0.8, size = 2))
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodepoint(aes(label = label), shape = 18, size = 3) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
library(ggplot2)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodepoint(aes(label = label), shape = 18, size = 3) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
p
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(label = label), size = 3) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
p
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(label = label), size = 3, hjust = 0.03) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(subset =!is.na(label) & label > 75, label = label), size = 3, hjust = 0.03) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
p
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(subset =!is.na(label) & label > 75, label = label), size = 3, hjust = 0.03) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(subset = label >75, label = label), size = 3, hjust = 0.03) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(label = label), size = 3, hjust = 0.03) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(MPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(label = label, ), size = 3, hjust = 0.03) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
ggtree(MPtree) +  geom_tiplab(align = T) + xlim(NA, 0.1) +
geom_text2(aes(subset = !isTip, label = node, hjust = 1.2, vjust = -0.8, size = 2))
png(filename = "MP-nodenums.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
ggtree(MPtree) +  geom_tiplab(align = T) + xlim(NA, 0.1) +
geom_text2(aes(subset = !isTip, label = node, hjust = 1.2, vjust = -0.8, size = 2))
dev.off()
midMPtree <- ape::root.phylo(MPtree, node = 83)
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(label = label, ), size = 3, hjust = 0.03) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
knitr::opts_chunk$set(echo = TRUE)
dd <-  read.delim("annotations-2.txt")
dd <-  dplyr::mutate(dd, newlab = paste(subtype, strain, sep='|'))
dd$source <- gsub("seal", "seal query sequence", dd$source )
mypalette <- c("gray" = "#737373",
"blue1" = "#9ecae1",
"blue2" = "#3182bd",
"red1" = "#fee0d2",
"red2" = "#fc9272",
"red3" = "#de2d26")
mylabels <- c("gray" = "other/unknown avian",
"blue1" = "human",
"blue2" = "seal",
"red1" = "charadriiformes",
"red2" = "anseriformes",
"red3" = "galliformes")
dd$colourName <- factor(dd$colourName,
levels = c("blue2", "blue1", "red1", "red2", "red3", "gray"))
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04)
library(treeio)
library(ggplot2)
library(ggtree)
MPtree <- read.tree("MP-hits-q-sed-mauto-trim.tre")
midMPtree <- ape::root.phylo(MPtree, node = 83)
midMPtree$node.label
dd <-  read.delim("annotations-2.txt")
dd <-  dplyr::mutate(dd, newlab = paste(subtype, strain, sep='|'))
dd$source <- gsub("seal", "seal query sequence", dd$source )
mypalette <- c("gray" = "#737373",
"blue1" = "#9ecae1",
"blue2" = "#3182bd",
"red1" = "#fee0d2",
"red2" = "#fc9272",
"red3" = "#de2d26")
mylabels <- c("gray" = "other/unknown avian",
"blue1" = "human",
"blue2" = "seal",
"red1" = "charadriiformes",
"red2" = "anseriformes",
"red3" = "galliformes")
dd$colourName <- factor(dd$colourName,
levels = c("blue2", "blue1", "red1", "red2", "red3", "gray"))
png(filename = "MP-ML-4.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <- ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04)
p <- p %<+% dd +
#geom_nodelab(aes(label = label), size = 3, hjust = 0.03) +
geom_tippoint(aes(color = colourName), size = 3) +
scale_color_manual(values=mypalette, labels=mylabels) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library(treeio)
library(ggplot2)
library(ggtree)
MPtree <- read.tree("MP-hits-q-sed-mauto-trim.tre")
midMPtree <- ape::root.phylo(MPtree, node = 83)
midMPtree$node.label
dd <-
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(subset =  !is.na(label), label = label), size = 3, hjust = 0.03) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) +# geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(subset =  !is.na(label), label = label), size = 3, hjust = 0.03) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) +# geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(label = label), size = 3, hjust = 0.03) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(label = label), size = 3, hjust = 0.03) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(label = label, colour = label), size = 3, hjust = 0.03) +
scale_colour_gradient(low = "white", high = "black") +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(label = label, colour = label), size = 3, hjust = 0.03) +
scale_colour_discrete(palette = "Set1")+
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(label = label, colour = label), size = 3, hjust = 0.03) +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(label = label, colour = label), size = 3, hjust = 0.03) +
scale_colour_distiller() +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
png(filename = "MP-ML-3.png",
res = 300,
height = 14*300,
width = 14*300,
pointsize = 14)
p <-  ggtree(midMPtree, ladderize = T) + geom_tiplab(align = T, hjust = -0.01) + xlim(NA, 0.04) +
geom_nodelab(aes(label = label, colour = label), size = 3, hjust = 0.03) +
scale_colour_brewer() +
#geom_tippoint(aes(color = Clade), size = 3) +
#scale_color_manual(values = cols) +
geom_treescale(offset = 2, y = -3) +
ggtitle("seal - MP (ML tree)") +
theme(text = element_text(size =18)) #+
#geom_hilight(node = 70, fill = "gray", alpha = .6, extendto  =  1)
p
dev.off()
